# 新興感染症のシステマティック・レビューを機械学習を用いて簡易に実施するための研究

## このリポジトリについて

このリポジトリには、医学論文に関する情報収集とスライド作成を自動化するための2つのシステムが含まれています。どちらのシステムも、Googleのサービス（Google Drive、Googleスプレッドシート、Googleスライド）と連携して動作します。

1.  **PubMed検索とスライド自動生成システム**:
    *   医学論文データベース「PubMed」から、指定したキーワードで論文を検索します。
    *   見つかった論文の情報をGoogleスプレッドシートにまとめます。
    *   まとめた情報をもとに、AI（OpenAI API）が論文のポイントを抽出し、Googleスライドのテンプレートを使って自動でスライドを作成します。
    *   新しいスライドができたらメールでお知らせします。

2.  **PDFからのスライド自動生成システム**:
    *   お手持ちの論文PDFファイルをGoogle Driveの指定フォルダにアップロードするだけで、そのPDFの内容をAI（Claude API）が読み取ります。
    *   論文のタイトル、要約、重要なポイントなどを抽出し、Googleスライドのテンプレートを使って自動でスライドを作成します。
    *   どのPDFが処理されたか、どのスライドが作られたかはGoogleスプレッドシートで管理されます。

これらのシステムを使うことで、論文情報を集めたり、発表用のスライドを作成したりする手間を大幅に減らすことができます。

---

## はじめに：Google Apps Script (GAS) とは？

このシステムは、「Google Apps Script（グーグル アップス スクリプト）」、略して「GAS（ガス）」というプログラミング言語で書かれています。

GASは、Googleのさまざまなサービス（Gmail、Google Drive、スプレッドシート、ドキュメント、スライドなど）を操作したり、連携させたりすることができる便利なツールです。

**専門的なプログラミング知識がなくても大丈夫！**
この説明書では、PCの操作に慣れていない方でも、コピー＆ペーストなどの簡単な操作でシステムを使えるように手順を説明します。

## 準備するもの（共通）

システムを利用するために、以下のものが必要です。

*   **Googleアカウント**: Gmailなどでお使いのGoogleアカウント。
*   **Google Drive**: ファイルを保存したり、システムを動かすために使います。
*   **Webブラウザ**: Google Chromeを推奨します。
*   **OpenAI APIキー**: 「PubMed検索とスライド自動生成システム」で論文の情報をAIに分析させるために必要です。
*   **Claude APIキー**: 「PDFからのスライド自動生成システム」でPDFの内容をAIに分析させるために必要です。

## システムを利用するための事前準備

システムを動かす前に、いくつかの準備が必要です。少し手順が多いですが、一つ一つ丁寧に行いましょう。

### 1. Google Driveに専用フォルダを作成する

まず、このシステムに関するファイル（コード、スライドテンプレート、生成されたスライドなど）をまとめておくための専用フォルダをGoogle Driveに作りましょう。

1.  Google Drive（[https://drive.google.com](https://drive.google.com)）を開きます。
2.  左上の「＋ 新規」ボタンをクリックし、「新しいフォルダ」を選びます。
3.  フォルダ名を入力します。例えば、「論文スライド自動生成」など、分かりやすい名前をつけましょう。
4.  「作成」ボタンをクリックします。

この後、ダウンロードしたコードファイルや、これから作成するスライドテンプレートなどは、このフォルダの中に保存していくと管理がしやすくなります。

### 2. スライドテンプレートを準備する

システムは、あらかじめ用意された「スライドのひな形（テンプレート）」をもとに新しいスライドを作成します。

*   **PubMed検索とスライド自動生成システム用**:
    *   このシステムでは、論文のタイトル、発行日、引用情報、要約などをスライドに記載します。
    *   テンプレートには、これらの情報をどこに表示するかを示す「目印（プレースホルダー）」が必要です。例えば、タイトルを表示したい場所に `{Title}` 、要約を表示したい場所に `{abstract}` といった目印を書いておきます。
    *   具体的なプレースホルダーの例：`{Title}`, `{PublicationDate}`, `{Citation}`, `{PMID}`, `{abstract}`, `{Journal}`, `{Thema}`, `{Summary}`
    *   `SlideGeneration_for_study.gs` の中の `createGoogleSlide` 関数を見ると、どのようなプレースホルダーが使われているか確認できます。

    *   **PDFからのスライド自動生成システム用**:
    *   このシステムでは、論文の原文タイトル、日本語タイトル、引用情報、論文の限界点、臨床的/研究的/政策的意義、要約などをスライドに記載します。
    *   こちらも同様にプレースホルダーが必要です。
    *   具体的なプレースホルダーの例：`{Title}`, `{Japanese_Title}`, `{Citation}`, `{Limitation}`, `{ClinicalImplication}`, `{ResearchImplication}`, `{PolicyImplication}`, `{Summary}`
    *   ご自身でスライドテンプレートを作成し、そのIDを控えておいてください。このIDは、後述するスクリプトプロパティで `PDF_SLIDE_TEMPLATE_ID` という名前で設定します。

**テンプレートの作成方法**:

1.  Googleスライド（[https://slides.google.com](https://slides.google.com)）を開きます。
2.  「新しいプレゼンテーションを作成」で空のスライドを作るか、既存のテンプレートをコピーします。
3.  スライドのデザインやレイアウトを整え、上記のプレースホルダーをテキストボックスなどを使って配置します。
4.  作成したスライドテンプレートは、先ほどGoogle Driveに作成した専用フォルダに保存しておくと良いでしょう。
5.  **重要**: 作成したスライドテンプレートのURLから「ID」を控えておきます。URLが `https://docs.google.com/presentation/d/ここにIDが表示されます/edit` のようになっている場合、`ここにIDが表示されます` の部分がIDです。このIDは後で設定に使います。

### 3. Googleスプレッドシートを準備する

システムは、設定情報を読み込んだり、処理結果を記録したりするためにGoogleスプレッドシートを使います。

*   **PubMed検索とスライド自動生成システム用**:
    1.  **検索条件を設定するシート**:
        *   検索したいキーワード、検索に含める雑誌名、除外する雑誌名、通知先のメールアドレスなどを記入します。
        *   `SearchAndSave.gs` の `loadSearchSettings` 関数を見ると、どのような項目が必要か分かります（例：シート名「シート1」に、検索キーワード、含める雑誌、除外する雑誌、メールアドレスの順でデータを入力）。
    2.  **検索結果を保存するシート**:
        *   PubMedから取得した論文情報（PubMed ID、タイトル、雑誌名、発行日、著者、URL、引用情報、要約など）が保存されます。
        *   `SearchAndSave.gs` の `saveToSpreadsheet` 関数で、シート名「SearchResults」にこれらの情報が書き込まれます。スライド生成の情報もこのシートに追加されていきます。

*   **PDFからのスライド自動生成システム用**:
    1.  **PDFの処理状況を管理するシート**:
        *   処理対象のPDFのID、ファイル名、処理状況（未処理、処理中、処理済、エラーなど）、生成されたスライドのURLなどが記録されます。
        *   `PDF_to_slides/ClaudeAPIHandler.gs` の `processNextPDF` 関数や `PDF_to_slides/SlideCreator.gs` の `updateFileStatus` 関数で、シート名「PDF処理状態」にこれらの情報が書き込まれます。

**スプレッドシートの作成方法**:

1.  Googleスプレッドシート（[https://sheets.google.com](https://sheets.google.com)）を開きます。
2.  「新しいスプレッドシートを作成」で空のシートを作ります。
3.  システムが必要とするシート名（例：「シート1」、「SearchResults」、「PDF処理状態」）に変更し、必要に応じてヘッダー行（各列のタイトル）を作成します。
4.  作成したスプレッドシートは、Google Driveの専用フォルダに保存しておくと良いでしょう。
5.  **重要**: 作成したスプレッドシートのURLから「ID」を控えておきます。このIDも後で設定に使います。

### 4. APIキーを取得して設定する

システムがAI機能（論文の分析や要約）を使うためには、それぞれのAIサービスの「APIキー」というものが必要です。これは、システムがAIサービスを利用するための「鍵」のようなものです。

*   **OpenAI APIキー (PubMed検索システム用)**:
    1.  OpenAIのウェブサイト（[https://platform.openai.com/](https://platform.openai.com/)）でアカウントを作成またはログインします。
    2.  APIキーのページ（通常、アカウント設定内やAPIセクションにあります）で新しいAPIキーを発行します。
    3.  発行されたAPIキーは一度しか表示されないことが多いので、必ずコピーして安全な場所に保管してください。
    4.  このAPIキーは、後述するGASの「スクリプトプロパティ」に `openai_api` という名前で設定します。

*   **Claude APIキー (PDFシステム用)**:
    1.  Anthropicのウェブサイト（[https://console.anthropic.com/](https://console.anthropic.com/)）でアカウントを作成またはログインします。
    2.  APIキーのページで新しいAPIキーを発行します。
    3.  同様に、発行されたAPIキーをコピーして安全な場所に保管してください。
    4.  このAPIキーは、後述するGASの「スクリプトプロパティ」に `CLAUDE_API_KEY` という名前で設定します。

**APIキーの取り扱いに関する注意**:
APIキーは、あなたのアカウントに紐づく重要な情報です。他人に知られないように厳重に管理してください。誤って公開してしまうと、不正利用される可能性があります。

---

## システム1：PubMedを検索してスライドを作る

### どんなことができるの？

*   あなたが指定したキーワード（例：「インフルエンザ ワクチン 効果」など）で、医学論文データベース「PubMed」を検索します。
*   見つかった論文の中から、新しいものや条件に合うものを選び出します。
*   選ばれた論文のタイトル、著者、雑誌名、発行日、要約などの情報を自動で集めて、Googleスプレッドシートに一覧表として記録します。
*   記録された論文について、AI（OpenAI）が内容を分析し、特に重要なポイント（テーマ、カテゴリ、時期、場所、対象者、論文のまとめ）を抽出します。
*   抽出された情報と、あなたが用意したスライドのひな形（テンプレート）を使って、自動で見やすいスライドを作成します。
*   作成されたスライドのURLもスプレッドシートに記録し、設定しておけばメールで通知もしてくれます。

これにより、毎日新しい論文情報をチェックし、簡単な報告スライドを作る作業を自動化できます。

### 使い方

#### 1. コードをGoogle Apps Scriptプロジェクトとして準備する

1.  このリポジトリから、以下の2つのファイルの内容をそれぞれコピーします。
    *   `SearchAndSave.gs`
    *   `SlideGeneration_for_study.gs`
2.  Google Driveの専用フォルダ内で、「＋ 新規」ボタンから「その他」>「Google Apps Script」を選び、新しいGASプロジェクトを作成します。（もし「Google Apps Script」が見当たらない場合は、Google Workspace Marketplaceから追加する必要があるかもしれません。）
3.  プロジェクト名（例：「PubMed論文スライド生成」）を付けます。
4.  GASエディタが開いたら、デフォルトで表示されている `コード.gs` の中身をすべて削除します。
5.  メニューの「ファイル」>「新規作成」>「スクリプトファイル」を選び、ファイル名 `SearchAndSave` を入力してOKします。作成されたファイルに、手順1でコピーした `SearchAndSave.gs` の内容を貼り付けます。
6.  同様に、メニューの「ファイル」>「新規作成」>「スクリプトファイル」を選び、ファイル名 `SlideGeneration_for_study` を入力してOKします。作成されたファイルに、手順1でコピーした `SlideGeneration_for_study.gs` の内容を貼り付けます。
7.  ファイルを保存します（フロッピーディスクのアイコン）。

#### 2. スクリプトプロパティを設定する

GASが正しく動作するためには、いくつかの設定情報（APIキーやスプレッドシートのIDなど）を「スクリプトプロパティ」という場所に登録する必要があります。これは、プログラムが外部のサービスを利用したり、特定のファイルを見つけたりするための「道しるべ」のようなものです。

**スクリプトプロパティの設定手順:**

1.  **プロジェクトの設定を開く**:
    *   GASエディタの画面左側にあるメニューの中から、**歯車の形をしたアイコン**（マウスカーソルを合わせると「プロジェクトの設定」と表示されます）をクリックします。

2.  **スクリプトプロパティのセクションを見つける**:
    *   「プロジェクトの設定」画面が開いたら、ページを下にスクロールしていくと、「**スクリプトプロパティ**」という項目が見つかります。

3.  **プロパティを追加する**:
    *   「スクリプトプロパティ」の項目の右側にある「**スクリプト プロパティを追加**」という青い文字のボタンをクリックします。
    *   すると、「プロパティ」と「値」という2つの入力欄が表示されます。

4.  **情報を入力する**:
    *   これから説明する必要な情報を、1行ずつ「プロパティ」と「値」のペアで入力していきます。
    *   例えば、最初の情報を入力したら、再度「スクリプト プロパティを追加」ボタンを押して次の入力欄を出し、必要な情報をすべて追加します。

    **入力する情報（システム1用）:**

    | プロパティ (Property)             | 値 (Value)                                                                 | 説明                                                                 |
    | :-------------------------------- | :------------------------------------------------------------------------- | :------------------------------------------------------------------- |
    | `SETTING_SPREADSHEET_ID`          | (検索条件を設定するスプレッドシートのID)                                       | 検索キーワードなどを記入するスプレッドシートのIDです。                   |
    | `SAVE_SPREADSHEET_ID`             | (検索結果を保存するスプレッドシートのID)                                       | 論文情報やスライドURLを保存するスプレッドシートのIDです。                |
    | `openai_api`                      | (あなたのOpenAI APIキー)                                                     | OpenAI APIを利用するためのキーです。                                   |
    | `folder_id`                       | (生成されたスライドを保存するGoogle DriveフォルダのID)                         | 作成されたGoogleスライドが保存されるフォルダのIDです。                   |
    | `Slide_template_id`               | (PubMed検索システム用のスライドテンプレートのID)                               | このシステムで使うスライドテンプレートのIDです。                         |
    | `spreadsheet_id`                  | (検索結果を保存するスプレッドシートのID ※`SAVE_SPREADSHEET_ID`と同じでOK) | `SlideGeneration_for_study.gs` が参照するスプレッドシートのIDです。 |
    | `setting_spreadsheet_id`          | (検索条件を設定するスプレッドシートのID ※`SETTING_SPREADSHEET_ID`と同じでOK) | `SlideGeneration_for_study.gs` が通知先メールアドレスを取得するシートのID。 |

    *   **IDの取得方法**: Googleスプレッドシートやフォルダ、スライドテンプレートを開いたときのブラウザのアドレスバーに表示されるURLの一部です。
        *   スプレッドシート: `https://docs.google.com/spreadsheets/d/【この部分がID】/edit`
        *   フォルダ: `https://drive.google.com/drive/folders/【この部分がID】`
        *   スライド: `https://docs.google.com/presentation/d/【この部分がID】/edit`
        *   APIキーは、各AIサービスのウェブサイトで取得した文字列をそのまま貼り付けます。

5.  **設定を保存する**:
    *   すべての情報を入力し終えたら、画面右上（または「スクリプトプロパティ」セクションの右上）にある「**スクリプト プロパティを保存**」という青いボタンをクリックします。これで設定が保存されます。

    | プロパティ (Property)             | 値 (Value)                                                                 | 説明                                                                 |
    | :-------------------------------- | :------------------------------------------------------------------------- | :------------------------------------------------------------------- |
    | `SETTING_SPREADSHEET_ID`          | (検索条件を設定するスプレッドシートのID)                                       | 検索キーワードなどを記入するスプレッドシートのIDです。                   |
    | `SAVE_SPREADSHEET_ID`             | (検索結果を保存するスプレッドシートのID)                                       | 論文情報やスライドURLを保存するスプレッドシートのIDです。                |
    | `openai_api`                      | (あなたのOpenAI APIキー)                                                     | OpenAI APIを利用するためのキーです。                                   |
    | `folder_id`                       | (生成されたスライドを保存するGoogle DriveフォルダのID)                         | 作成されたGoogleスライドが保存されるフォルダのIDです。                   |
    | `Slide_template_id`               | (PubMed検索システム用のスライドテンプレートのID)                               | このシステムで使うスライドテンプレートのIDです。                         |
    | `spreadsheet_id`                  | (検索結果を保存するスプレッドシートのID ※`SAVE_SPREADSHEET_ID`と同じでOK) | `SlideGeneration_for_study.gs` が参照するスプレッドシートのIDです。 |
    | `setting_spreadsheet_id`          | (検索条件を設定するスプレッドシートのID ※`SETTING_SPREADSHEET_ID`と同じでOK) | `SlideGeneration_for_study.gs` が通知先メールアドレスを取得するシートのID。 |

    *   **IDの取得方法**: Googleスプレッドシートやフォルダ、スライドテンプレートを開いたときのブラウザのアドレスバーに表示されるURLの一部です。
        *   スプレッドシート: `https://docs.google.com/spreadsheets/d/【この部分がID】/edit`
        *   フォルダ: `https://drive.google.com/drive/folders/【この部分がID】`
        *   スライド: `https://docs.google.com/presentation/d/【この部分がID】/edit`

4.  入力が終わったら、「スクリプト プロパティを保存」をクリックします。

#### 3. 検索条件用スプレッドシートを準備・記入する

スクリプトプロパティで `SETTING_SPREADSHEET_ID` に指定したスプレッドシートを開き、検索条件を記入します。
`SearchAndSave.gs` の `loadSearchSettings` 関数によると、シート名「シート1」の2行目に以下の情報を順番に入力します。

*   **A列**: 検索キーワード (例: `influenza vaccine effectiveness`)
*   **B列**: 検索結果に含めたい雑誌名 (複数ある場合はカンマ区切り。例: `Lancet,NEJM`)。特に指定がなければ空欄でOK。
*   **C列**: 検索結果から除外したい雑誌名 (複数ある場合はカンマ区切り)。特に指定がなければ空欄でOK。
*   **D列**: 通知を受け取りたいメールアドレス。

#### 4. 実行方法

*   **手動で実行する場合**:
    1.  GASエディタの上部にある関数選択のプルダウンメニューから、まず `main` （`SearchAndSave.gs` 内）を選び、「実行」ボタン（再生マークのアイコン）をクリックします。初回実行時には、Googleアカウントへのアクセス許可を求められるので、許可してください。これによりPubMedの検索とスプレッドシートへの保存が行われます。
    2.  次に、同じプルダウンメニューから `executeSlideGeneration` （`SlideGeneration_for_study.gs` 内）を選び、「実行」ボタンをクリックします。これによりスライドが生成され、通知が送られます。

*   **毎日自動で実行する場合（トリガー設定）**:
    1.  GASエディタの左側メニューにある時計のアイコン（トリガー）をクリックします。
    2.  右下の「トリガーを追加」ボタンをクリックします。
    3.  以下のように設定します。
        *   **実行する関数を選択**: `main`
        *   **実行するデプロイを選択**: `Head`
        *   **イベントのソースを選択**: `時間主導型`
        *   **時間ベースのトリガーのタイプを選択**: `日付ベースのタイマー` (または `日タイマー`)
        *   **時刻を選択**: 実行したい時刻（例: 午前8時～9時）
    4.  「保存」をクリックします。
    5.  同様に、もう一つトリガーを追加します。
        *   **実行する関数を選択**: `executeSlideGeneration`
        *   他は上記と同じように設定しますが、`main` の実行が終わった後（例えば10分～15分後）に実行されるように時刻を設定します。
    6.  「保存」をクリックします。

    これで、毎日指定した時刻に自動で論文検索とスライド生成が行われるようになります。

### 生成されたスライドはどこにあるの？

スクリプトプロパティの `folder_id` で指定したGoogle Driveフォルダの中に、日付と論文IDを含んだファイル名で保存されます。
また、`SAVE_SPREADSHEET_ID` で指定したスプレッドシートの「SearchResults」シートにも、生成されたスライドのURLが記録されます。

---

## システム2：PDFファイルからスライドを作る

### どんなことができるの？

*   あなたが持っている論文のPDFファイルを、Google Driveの特定のフォルダにアップロードします。
*   システムがそのフォルダを定期的にチェックし、新しいPDFファイルを見つけます。
*   見つかったPDFの内容をAI（Claude）が読み取り、論文のタイトル（原文と日本語訳）、引用情報、論文の限界点、臨床的・研究的・政策的な意義、そして論文全体の要約などを抽出します。
*   抽出されたこれらの情報を、あなたが用意したスライドのひな形（テンプレート）に当てはめて、自動でスライドを作成します。
*   どのPDFが処理され、どんなスライドが作られたかは、Googleスプレッドシートに記録されて管理できます。

これにより、手元にあるPDF論文から、発表や情報共有のためのスライドを素早く作成することができます。

### 使い方

#### 1. コードをGoogle Apps Scriptプロジェクトとして準備する

1.  このリポジトリの `PDF_to_slides` フォルダにある、以下の2つのファイルの内容をそれぞれコピーします。
    *   `ClaudeAPIHandler.gs`
    *   `SlideCreator.gs`
2.  システム1と同様に、Google Driveの専用フォルダ内で新しいGASプロジェクトを作成します（例：「PDF論文スライド生成」）。
3.  デフォルトの `コード.gs` の中身を削除します。
4.  メニューの「ファイル」>「新規作成」>「スクリプトファイル」を選び、ファイル名 `ClaudeAPIHandler` を入力してOKします。作成されたファイルに、手順1でコピーした `ClaudeAPIHandler.gs` の内容を貼り付けます。
5.  同様に、ファイル名 `SlideCreator` で新しいスクリプトファイルを作成し、`SlideCreator.gs` の内容を貼り付けます。
6.  ファイルを保存します。

#### 2. Googleサービスへのアクセスを有効にする

このシステムは、Google Drive、Googleスプレッドシート、GoogleスライドといったGoogleのサービスを操作します。そのため、作成したGASプロジェクトがこれらのサービスにアクセスできるように設定（有効化）する必要があります。これは、APIキーを別途取得・設定するのとは異なります。

1.  GASエディタの左側メニューにある「サービス」という項目の横に表示されている「＋」（サービスを追加）ボタンをクリックします。
2.  表示されたリストから、以下のサービスを探し、それぞれ選択して「追加」ボタンをクリックします。
    *   **Drive API** (Google Driveを操作するために必要)
    *   **Google Sheets API** (Googleスプレッドシートを操作するために必要)
    *   **Google Slides API** (Googleスライドを操作するために必要)

    これにより、スクリプトがこれらのGoogleサービスを利用する許可を得ます。

#### 3. スクリプトプロパティを設定する

システム1と同様の手順で、こちらのシステム用のスクリプトプロパティも設定します。

1.  **プロジェクトの設定を開く**:
    *   GASエディタの画面左側にあるメニューの中から、**歯車の形をしたアイコン**（プロジェクトの設定）をクリックします。

2.  **スクリプトプロパティのセクションを見つける**:
    *   「プロジェクトの設定」画面を下にスクロールし、「**スクリプトプロパティ**」の項目を見つけます。

3.  **プロパティを追加・入力する**:
    *   「**スクリプト プロパティを追加**」ボタンを使い、以下の情報を1行ずつ「プロパティ」と「値」のペアで入力していきます。

    **入力する情報（システム2用）:**

    | プロパティ (Property)         | 値 (Value)                                                              | 説明                                                                   |
    | :---------------------------- | :---------------------------------------------------------------------- | :--------------------------------------------------------------------- |
    | `PDF_FOLDER_ID`               | (PDFファイルが保存されているGoogle DriveフォルダのID)                     | このフォルダにアップロードされたPDFが処理対象になります。                  |
    | `TRACKING_SPREADSHEET_ID`     | (処理状況を管理するスプレッドシートのID)                                  | PDFの処理状況やスライドURLを記録するスプレッドシートのIDです。             |
    | `CLAUDE_API_KEY`              | (あなたのClaude APIキー)                                                  | Claude APIを利用するためのキーです。                                     |
    | `SLIDE_OUTPUT_FOLDER_ID`      | (生成したスライドを保存するGoogle DriveフォルダのID)                      | 作成されたGoogleスライドが保存されるフォルダのIDです。                     |
    | `PDF_SLIDE_TEMPLATE_ID`       | (PDFシステム用のスライドテンプレートのID)                                 | このシステムで使うスライドテンプレートのIDです。                         |

    *   **IDの取得方法**はシステム1の説明を参照してください。APIキーはClaudeのウェブサイトで取得した文字列をそのまま貼り付けます。

4.  **設定を保存する**:
    *   すべての情報を入力し終えたら、「**スクリプト プロパティを保存**」ボタンをクリックします。

#### 4. PDFファイルを指定のGoogle Driveフォルダにアップロードする

スクリプトプロパティの `PDF_FOLDER_ID` で指定したGoogle Driveフォルダに、スライドを作成したい論文のPDFファイルをアップロードします。

#### 5. 実行方法

*   **手動で実行する場合**:
    *   **特定のフォルダ内の全ての未処理PDFを処理**: GASエディタの上部にある関数選択のプルダウンメニューから `processAllPDFsInFolder` （`SlideCreator.gs` 内）を選び、「実行」ボタンをクリックします。初回実行時にはアクセス許可を求められます。
    *   **スプレッドシートに登録された次の未処理PDFを1件処理**: `TRACKING_SPREADSHEET_ID` で指定したスプレッドシートの「PDF処理状態」シートに手動でPDFのIDなどを登録した後、関数 `processNextPDF` （`ClaudeAPIHandler.gs` 内）を実行します。

*   **毎日自動で実行する場合（トリガー設定）**:
    1.  `PDF_to_slides/README.md` や `SlideCreator.gs` の `setupTrigger` 関数の説明にある通り、この関数を実行すると、毎日午前9時に `processAllPDFsInFolder` が自動実行されるトリガーが設定されます。
    2.  GASエディタの関数選択プルダウンから `setupTrigger` を選び、「実行」ボタンをクリックします。
    3.  これで、毎日指定フォルダ内の新しいPDFが自動的に処理されるようになります。時刻などを変更したい場合は、GASエディタの左側メニュー「トリガー」から設定を編集してください。

### 生成されたスライドはどこにあるの？

スクリプトプロパティの `SLIDE_OUTPUT_FOLDER_ID` で指定したGoogle Driveフォルダの中に、処理日時と論文タイトルの一部を含んだファイル名で保存されます。
また、`TRACKING_SPREADSHEET_ID` で指定したスプレッドシートの「PDF処理状態」シートにも、生成されたスライドのURLが記録されます。

---

## 困ったときは

### Q. エラーが出てうまく動かない…
A. まずはエラーメッセージを確認してみましょう。GASエディタの「実行ログ」を見ると、どこで問題が起きているかの手がかりが得られることがあります。
    *   **ログの確認方法**: GASエディタの左側メニューにある書類にチェックマークがついたようなアイコン（実行数）をクリックすると、過去の実行履歴とログが表示されます。
    *   よくある原因としては、スクリプトプロパティの設定ミス（IDやAPIキーの入力間違い）、Google Driveのフォルダやファイルへのアクセス権限不足、APIキーの有効期限切れや利用上限超過などがあります。

### Q. APIキーの設定方法がよくわからない…
A. 「システムを利用するための事前準備」の「4. APIキーを取得して設定する」の項目と、「使い方」の中の「スクリプトプロパティを設定する」の項目をもう一度よく読んでみてください。APIキーは、それぞれのAIサービスのウェブサイトで取得し、GASの「プロジェクトの設定」>「スクリプトプロパティ」に正しい「プロパティ名」で登録する必要があります。

### Q. スライドテンプレートのプレースホルダーって何？
A. プレースホルダーとは、スライドテンプレートの中に「ここにはこの情報を表示する」という目印として書いておく特別な文字列のことです。例えば、`{Title}` と書いておけば、システムが論文のタイトルをそこに自動で挿入してくれます。各システムの説明で挙げたプレースホルダーを参考に、ご自身のテンプレートに設定してください。

### Q. Google Apps Scriptの実行時間制限とは？
A. Google Apps Scriptの無料版では、1回のスクリプト実行時間に制限があります（通常6分間）。一度に大量の論文を処理したり、非常に大きなPDFファイルを扱ったりすると、この時間制限を超えてしまい、処理が途中で止まってしまうことがあります。
    *   「PDFからのスライド自動生成システム」では、一度に処理するファイル数を制限する工夫がされています (`processAllPDFsInFolder` 関数内)。
    *   もし頻繁に時間切れになる場合は、処理する量を減らすか、トリガーの実行間隔を調整するなどの対策が必要になるかもしれません。

# log

2025-02-17 PubMed > sheetを実装
2025-02-18 スライド作成のモック
2025-05-12 alphaリリース

# 謝辞 (Acknowledgements)

本研究は、以下の研究助成を受けて実施されました。

- 研究課題名: 新興感染症のシステマティック・レビューを機械学習を用いて簡易に実施するための研究
- 研究課題/領域番号: 24K13518
- KAKEN: [https://kaken.nii.ac.jp/ja/grant/KAKENHI-PROJECT-24K13518/](https://kaken.nii.ac.jp/ja/grant/KAKENHI-PROJECT-24K13518/)
