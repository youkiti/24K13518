# Requirements Definition: PubMed検索とスライド自動生成システム (GAS実装版)

## 概要
本システムは、毎日PubMedから「m pox」および「monkey pox」をキーワードに検索を実行し、CSV形式で保存された設定ファイルから指定された組入・除外条件を適用します。検索結果からユニークなレコードを抽出し、所定のフォーマットに従ってスプレッドシート（またはCSV形式）へ1行ずつ記録します。その後、記録されたデータを基に、OpenAI APIを利用してstructured output形式の指示を生成し、Googleスライドを自動的に作成、さらにそのURLをメール通知します。

システムはGoogle Apps Script (GAS)を利用して実装され、3つの主要な機能モジュールに分割されます。

## 機能要件

### 1. 設定管理とフィルタ（CSV版）
- リポジトリ内に、PubMed検索用の設定情報をCSV形式で保存する。（例：mpox[tiab] OR monkey pox[tiab])
- CSVファイルには、検索キーワード（含む・除外条件）およびジャーナル名の組入・除外フィルタ、APIを使用する者のメールアドレスを定義。
- ユーザーはこのCSVファイルを直接編集し、必要な設定を管理する。

### 2. PubMed検索と結果保存
- 別のGASスクリプトにより、CSV設定ファイルから条件を読み取り、PubMed検索クエリを自動生成・実行する。
- PubMed APIを使用して最新30件の結果を取得し、PubMed IDをキーにして重複チェックおよび削除する処理を実装する。
- 重複除去後のユニークなレコードを、既存のスプレッドシートまたはCSV出力形式に1行ずつ保存する。
- この処理は、GASタイムトリガーを用いて毎日1回自動実行される。

### 3. Googleスライド生成と通知
- さらに別のGASスクリプトにより、保存された検索結果データを入力として読み込み、OpenAI APIを用いてstructured output形式でGoogleスライド生成の指示を行う。
| 項目               | 内容   |
|--------------------|------|
| **Theme**         |      |
| **Event type**    |      |
| **Date of Report**|      |
| **Reporter**      |      |
| **Article title** |      |
| **Information source** |  |
| **Reason for report** |  |
| **Category**      |      |
| **Time**         |      |
| **Place**        |      |
| **Person**       |      |
| **Summary of Article** | |
| **Risk assessment** | |
| **Action**       |      |


- 生成されるスライドは、ファイル名を「出版日_雑誌名_論文名」として作成される。
- 完成したスライドのURLは、メール通知によりユーザーへ送信される（Gmail API等を使用）。

## 非機能要件
- **自動化**: GASタイムトリガーにより、1日1回確実に実行されること。
- **拡張性**: CSV設定ファイルにより、検索条件、フィルタ、通知先などの変更が容易に行えること。
- **保守性**: 各機能を独立したスクリプトとして管理し、個別にテスト・デバッグが可能であること。
- **ユーザビリティ**: リポジトリ内CSVファイルを用いることで、非エンジニアでも直感的に設定変更できること。
